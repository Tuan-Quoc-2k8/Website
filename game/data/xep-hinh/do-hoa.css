    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --accent:#10b981;
      --muted:#94a3b8;
      --grid-border:#f8fafc;
      --replace-color: #10b981; /* màu đồng nhất cho khung thay khối */
      --modal-bg: rgba(2,6,23,0.6);
      --menu-bg: #071827;
    }

    *{ 
      box-sizing:border-box;
      font-family:Inter, Arial, sans-serif;
      margin:0;
      padding:0;
    }
    body{
      background:linear-gradient(180deg,#071024,var(--bg));
      color:#e6eef6;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      margin:0;
    }

    .wrap{
      display:grid;
      grid-template-columns:360px 360px;
      gap:24px;
      align-items:start;
      width:100%;
      max-width:780px;
    }

    .panel{
      background:var(--panel);
      padding:16px;
      border-radius:12px;
      box-shadow:0 6px 20px rgba(2,6,23,.6);
      overflow:visible;
    }

    h3{margin:0 0 10px 0;font-size:16px}

    /* Board */
    .board-container {
      position: relative;
      width:320px;
      height:320px;
    }
    .board{
      width:100%;
      height:100%;
      display:grid;
      grid-template-columns:repeat(8,1fr);
      grid-template-rows:repeat(8,1fr);
      gap:4px;
      background:#071227;
      padding:6px;
      border-radius:8px;
      border:2px solid var(--grid-border);
    }
    .cell{
      background:#06131d;
      border-radius:6px;
      user-select:none;
      transition:background .18s, outline .12s;
      width:100%; height:100%;
    }
    .cell.filled{background:#0b6b4f}
    .cell.preview-ok{outline:2px solid rgba(16,185,129,.6)}
    .cell.preview-bad{outline:2px solid rgba(239,68,68,.6)}
    .cell.clearing{animation:clearLine .4s forwards}

    @keyframes clearLine{
      0%{background:#16a34a}
      100%{background:#06131d}
    }

    /* Controls / Queue */
    .controls{display:flex;flex-direction:column;gap:14px}
    .queue{display:flex;gap:8px;align-items:center}
    .piece-slot{
      width:96px;height:96px;
      background:#03111a;
      border-radius:10px;
      padding:6px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      position:relative;
      transition:transform .15s, outline .12s;
      flex-shrink:0;
    }
    .piece-slot:hover{transform:scale(1.05)}
    .piece-slot.disabled{opacity:.35;cursor:default;transform:none}
    .piece-slot.highlight{outline:2px dashed var(--accent)}

    .mini-piece{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      grid-template-rows:repeat(4,1fr);
      gap:4px;
      width:84px;height:84px;
      background:#021015;
      border-radius:6px;
      padding:2px;
    }
    .mini-cell{
      width:100%;height:100%;
      background:transparent;
      border-radius:3px;
      transition:background .12s;
    }
    .mini-cell.on{background:linear-gradient(180deg,#12b886,#0ea36b)}

    .storage{
      width:96px;height:96px;
      background:#03111a;
      border-radius:10px;
      padding:6px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition:transform .15s, outline .12s;
    }
    .storage:hover{transform:scale(1.05)}
    .storage.highlight{outline:2px dashed var(--accent)}

    .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    button{
      background:transparent;
      border:1px solid rgba(255,255,255,.06);
      color:var(--muted);
      padding:6px 10px;
      border-radius:8px;
      cursor:pointer;
      transition:all .16s;
      font-size:13px;
    }
    button:hover{border-color:var(--accent);color:var(--accent)}
    button.primary{border-color:var(--accent);color:var(--accent)}

    .info{display:flex;flex-direction:column;gap:8px}
    .score{font-size:18px;color:var(--accent);font-weight:700}
    .hint{color:var(--muted);font-size:13px}

    .powerups{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
    .powerups button{flex:1;font-size:13px;border-color:var(--accent);color:var(--accent)}
    .powerups button:disabled{opacity:.4;cursor:default}

    /* Modal (Replace menu) */
    .modal-backdrop{
      display:none; /* show bằng JS */
      position:fixed;
      inset:0;
      background:var(--modal-bg);
      z-index:900;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .replace-menu{
      width: min(560px, 92%);
      background:var(--menu-bg);
      border-radius:10px;
      padding:12px;
      box-shadow:0 10px 30px rgba(2,6,23,.8);
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      z-index:910;
    }
    .replace-header{
      display:flex;align-items:center;justify-content:space-between;
      gap:12px;padding-bottom:6px;border-bottom:1px solid rgba(255,255,255,0.03);
    }
    .replace-title{color:var(--accent);font-weight:600}
    .replace-close{
      background:transparent;border:none;color:#e6eef6;font-size:16px;cursor:pointer;padding:6px;border-radius:6px;
    }
    .replace-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(88px,1fr));
      gap:8px;
      max-height:52vh;
      overflow:auto;
      padding-top:6px;
    }
    .replace-item{
      background:rgba(255,255,255,0.02);
      padding:6px;border-radius:8px;display:flex;align-items:center;justify-content:center;
      cursor:pointer;border:1px solid rgba(255,255,255,0.03);
      transition:transform .12s, box-shadow .12s;
    }
    .replace-item:hover{transform:translateY(-4px);box-shadow:0 8px 18px rgba(2,6,23,.6)}
    .replace-mini .mini-cell.on{ background: var(--replace-color) !important; box-shadow: inset 0 -6px 12px rgba(0,0,0,0.12); }

    .muted{color:var(--muted);font-size:13px}
    .center{display:flex;align-items:center;justify-content:center}
    .flex{display:flex;gap:8px;align-items:center}

    /* responsive tweak */
    @media (max-width:760px){
      .wrap{grid-template-columns:1fr;max-width:420px}
      .board-container {
        width:100%;
        max-width:90vw;
        /* đảm bảo cao = rộng để vuông */
        height: auto;
      }
      .board {
        /* khi container thay đổi, dùng padding-top trick để giữ tỉ lệ vuông */
        position: relative;
      }
    }

    /* Thông báo giữa bảng */
    #centerMessage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 999;
      font-size: 32px;
      font-weight: bold;
      color: white;
      background: rgba(0,0,0,0.6);
      padding: 16px 32px;
      border-radius: 12px;
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    #centerMessage.show {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.05);
    }